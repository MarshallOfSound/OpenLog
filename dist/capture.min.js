var Logger=function(){this.l=window.location,this.SERVER=this.l.protocol+"//"+this.l.hostname+":4783/log",this.LOGGING_LEVELS={info:!0,warn:!0,error:!0};var a,b,c="openLogQueue",d=localStorage,e=document.getElementsByTagName("script"),f=this;for(this.o={error:console.error,info:console.info,log:console.log,warn:console.warn},this.queue=JSON.parse(d.getItem(c)||"[]"),d.removeItem(c),window.onbeforeunload=function(){d.setItem(c,JSON.stringify(f.queue))},setInterval(function(){f.sending||f.sendQueue.call(f)},1e3),a=0;a<e.length;a++){if(b=e[a].getAttribute("data-capture"),url=e[a].getAttribute("data-log-url"),url=/\/log\/?$/i.test(url)?url:url+"/log",r=e[a].getAttribute("data-restrict-to"),url&&(this.SERVER=url),b){for(b=b.split(" "),this.LOGGING_LEVELS={info:!1,warn:!1,error:!1},a=0;a<b.length;a++)this.set(b[a],!0);break}r&&(this.DOMAIN_RESTRICTION=r)}this.oneEquals=function(a,b){return!(!a||!b)&&a.split(" ").indexOf(b)!==-1}};Logger.prototype={console:function(a){this.o.log.apply(console,[a])},error:function(){console.error.apply(console,arguments)},info:function(){console.info.apply(console,arguments)},warn:function(){console.warn.apply(console,arguments)},sendQueue:function(){if(this.queue.length>0){var a=new XMLHttpRequest,b=this;b.sending=!0,a.open("post",this.SERVER,!0),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.onload=function(){b.queue=[],b.sending=!1},a.onerror=function(){b.sending=!1},a.send("["+this.queue.join(", ")+"]")}},_send:function(a,b,c){var d=this.LOGGING_LEVELS[a]||!1,e=this.oneEquals(this.DOMAIN_RESTRICTION,this.l.hostname)||!this.DOMAIN_RESTRICTION;d&&e&&this.LOGGING_LEVELS[a]&&this.queue.push(JSON.stringify({type:a,message:b,trace:c||Error().trace,time:Date.now(),page:this.l.href}))},set:function(a,b){"undefined"!=typeof this.LOGGING_LEVELS[a]&&(this.LOGGING_LEVELS[a]=b)}};for(var Log=new Logger,types=["error","info","log","warn"],i=0;i<types.length;i++)!function(){var a=i;console[types[a]]=function(){Log._send(types[a],arguments,Error().stack),Log.o[types[a]].apply(this,arguments)}}();window.onerror=function(a,b,c,d,e){Log._send("error",a,e.stack)},window.Log=Log;